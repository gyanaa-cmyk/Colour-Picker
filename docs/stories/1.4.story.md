---
epic: 1
story: 4
title: Color History Panel
status: Approved
---

# Story 1.4: Color History Panel

**As a designer,**
I want to see a list of my recently selected colors,
**so that** I can easily re-select or compare them.

## Acceptance Criteria

1.  Every time a new color is selected (either via manual input or eyedropper), it is added to the top of a "History" list.
2.  The history list displays a swatch of each color.
3.  The history list is persisted in the browser's local storage.
4.  Clicking on a color in the history list updates the main color preview and inputs to that color.

## Dev Notes

### Previous Story Insights
- Story 1.2 "Manual Color Input & Preview" is in Draft status.
- Story 1.3 "Eyedropper Implementation" is in Draft status.
- Project initialized with Vite and React/TypeScript in `frontend/` directory.
- ESLint and Prettier configured.
- Basic `App.tsx` component rendering "Colour Picker" heading.
- Git repository updated with frontend files.

### Component Specifications
- Components should follow `PascalCase` naming convention. [Source: docs/ui-architecture/component-standards.md#naming-conventions]
- Props must be typed using TypeScript interfaces. [Source: docs/ui-architecture/frontend-developer-standards.md#critical-coding-rules]
- Use `styled-components` for component-level styling. [Source: docs/ui-architecture/styling-guidelines.md#styling-approach]
- `HistoryPanel.tsx` and `HistoryItem.tsx` components are suggested in the project structure, located in `src/features/color-history`. [Source: docs/ui-architecture/project-structure.md]

### State Management
- Zustand is chosen for global state management. [Source: docs/ui-architecture/frontend-tech-stack.md#technology-stack-table]
- The `useColorStore` is the suggested store for color state, located in `src/store/useColorStore.ts`. [Source: docs/ui-architecture/state-management.md#store-structure]
- The `useColorStore` template includes `history` and `addToHistory` which will be crucial for managing the color history. It also includes `persist` middleware for local storage. [Source: docs/ui-architecture/state-management.md#state-management-template-zustand]
- The `setActiveColor` function from `useColorStore` will be used when clicking on a color in the history list.

### File Locations
- New components related to color history should be placed in `src/features/color-history`. [Source: docs/ui-architecture/project-structure.md]
- The `useColorStore` is in `src/store/useColorStore.ts`. [Source: docs/ui-architecture/state-management.md#store-structure]

### Testing
- Use Vitest and React Testing Library for testing. [Source: docs/ui-architecture/frontend-tech-stack.md#technology-stack-table]
- Component tests should follow the provided template. [Source: docs/ui-architecture/testing-requirements.md#component-test-template-vitest-react-testing-library]

### Technical Constraints
- All components must be functional components using React Hooks. [Source: docs/ui-architecture/frontend-developer-standards.md#critical-coding-rules]
- No business logic should reside directly in JSX; extract it to handlers or hooks. [Source: docs/ui-architecture/frontend-developer-standards.md#critical-coding-rules]

### Styling
- Global theme variables are defined in `src/styles/theme.ts`. [Source: docs/ui-architecture/styling-guidelines.md#global-theme-variables]

### Local Storage
- The `useColorStore` template already includes `persist` middleware with `name: 'color-picker-storage'` for local storage. This should be utilized for persisting the history list. [Source: docs/ui-architecture/state-management.md#state-management-template-zustand]

## Tasks / Subtasks

1.  **Update `useColorStore` (AC: 1, 3)**
    - [ ] Ensure `useColorStore` correctly adds new colors to the `history` array using `addToHistory`.
    - [ ] Verify that the `persist` middleware is correctly configured and working for local storage.
    - [ ] Implement logic to limit the history to a reasonable number of entries (e.g., 20, as in the template).
2.  **Create HistoryItem Component (AC: 2)**
    - [ ] Create `src/features/color-history/HistoryItem.tsx`.
    - [ ] This component should display a color swatch and potentially the color value.
    - [ ] It should accept a `color` prop and an `onClick` handler.
3.  **Create HistoryPanel Component (AC: 2, 4)**
    - [ ] Create `src/features/color-history/HistoryPanel.tsx`.
    - [ ] This component should retrieve the `history` array from `useColorStore`.
    - [ ] Render a list of `HistoryItem` components.
    - [ ] Implement the `onClick` handler for `HistoryItem` to call `setActiveColor` from `useColorStore` with the clicked color.
4.  **Integrate HistoryPanel (AC: 1)**
    - [ ] Integrate the `HistoryPanel` component into `App.tsx` or a suitable layout component.
    - [ ] Ensure that `addToHistory` is called from `ColorInputs` (from Story 1.2) and `Eyedropper` (from Story 1.3) whenever a new color is selected.
5.  **Testing**
    - [ ] Write unit tests for `HistoryItem.tsx`.
    - [ ] Write unit tests for `HistoryPanel.tsx` covering rendering of history items and click interactions.
    - [ ] Write integration tests to verify that colors are added to history, persisted, and that clicking history items updates the main color.

## Change Log

| Date       | Version | Description                  | Author |
| :--------- | :------ | :--------------------------- | :----- |
| 2025-10-04 | 1.0     | Initial draft of Story 1.4   | Bob    |

## Dev Agent Record

### Agent Model Used
_TBD_

### Debug Log References
_TBD_

### Completion Notes List
_TBD_

### File List
_TBD_

## QA Results
_TBD_
